title: (转)全局快门和卷帘快门
date: 2018-07-27 11:59:54
categories: Learning

tags: [computer vision]
---

　　快门是工业相机中一个重要组成部分，它的组成结构、形式及功能是衡量照相机档次的一个重要因素。常见的电子快门的方式有全局快门（Global Shutter）和卷帘快门（Rolling Shutter）两种。

<!-- more -->

> 　　全局快门是通过整幅图片在同一时间曝光实现的。传感器的所有像素点同时收集光线，同时曝光。当预设的曝光时间到了，传感器停止收集光线，并将曝光图像转成电子图像。在这个过程中，并没有实际意义上的快门存在。在曝光开始的时候，传感器开始收集光线；在曝光结束的时候，光线收集电路被切断，传感器读出值即为一副图片。
>
> 　　而卷帘快门与全局快门不同，它是通过控制芯片逐行曝光的方式实现的。卷帘快门也没有实际意义上的快门，而是通过通断电控制传感器，使其不同部分在不同时间下对光的敏感度不同。逐行进行曝光，直至所有像素点都被曝光。当然，所有的动作在很短的时间内完成，一般情况为1/48至1/60秒。需要注意的是，卷帘式快门采用的是逐行曝光的方式。假如物体或摄像头在拍摄期间处于快速运动状态，拍摄结果就可能出现“倾斜”、“摇摆不定”或“部分曝光”等任一种情况。
>
> ​       卷帘快门是逐行顺序曝光，所以不适合运动物体的拍摄。当采用全局快门方式曝光时，所有像素在同一时刻曝光，类似于将运动物体冻结了，所以适合拍摄快速运动的物体。但是全局快门可能出现像糊现象。像糊现象出现与否取决于曝光时间的长短。假如曝光时间过长，且物体运动过快则会出现像糊；假如曝光时间很短，类似于运动物体在瞬间被冻结了，则少有像糊。

### 1. CCD和CMOS

　　图像传感器的作用是将光学图像转换为数字信号，该信号随后可由图像信号处理器处理。广泛用于相机的两种图像传感器类型是科学级电荷耦合器件（CCD）和科学互补金属氧化物半导体（CMOS或sCMOS）。这两种技术之间存在许多相似之处，但一个主要区别是每个传感器读取在给定像素处累积的信号的方式。

<center>![CCD和CMOS的基本结构](https://pic3.zhimg.com/80/v2-82e827d8d52fa71f86360e08c3771b1e_hd.jpg)</center>
<p align="center">图1. CCD和CMOS的基本结构</p>

### 2. 卷帘快门

　　CMOS传感器有两种快门方式，卷帘快门(rolling shutter)和全局快门(global shutter)。卷帘快门通过对每列像素使用A/ D来提高读取速度，每列像素数量可达数千。任何一个转换器数字化的像素总数显着减少，从而缩短了读取时间，从而缩短了帧速率。虽然有许多并行A/ D共享工作负载，但整个传感器阵列仍必须转换为一个一次排。这导致每行读出之间的时间延迟很小。不是等待整个帧完成读出，以进一步最大化帧速率，每个单独的行通常能够在完成前一帧的读出后开始下一帧的曝光。快速时，每行读数之间的时间延迟转换为每行开始曝光之间的延迟，使它们不再同时发生。结果是帧中的每一行将暴露相同的时间量，但在不同的时间点开始曝光，允许两帧的重叠曝光。最终帧速率取决于滚动读出过程的完成速度。一个典型的读取过程如下所示：

<center>![preview](https://pic4.zhimg.com/80/v2-ddc080c11e5a1cf3147dfef01a9e83d7_hd.jpg)</center>

　　和机械式焦平面快门一样，卷帘快门对高速运动的物体会产生明显的变形。而且因为其扫描速度比机械式焦平面快门慢，变形会更加明显。例如如果数据的读出速度是每秒20帧，那么图像顶部和底部的曝光先后差异将多达50毫秒。

　　CMOS图像阵列的图形描述如图2。每行中的QRS晶体管的栅极都将连接到像素阵列左侧的行选择电路，从而允许控制哪一行像素应连接到列放大器。在阵列的顶部，所有源极跟随器输出将通过行选择晶体管连接到列放大器。为了产生数字数字，来自列放大器的信号被提供给模数转换器，该模数转换器对于所有列放大器是通用的，或者为了提高转换速度，为每列复制

<center>![左：CMOS传感器示意图 右：卷帘快门“果冻”效应](https://pic3.zhimg.com/v2-0565dea47aedba0b68af08b810e7acde_r.jpg)</center>
<p align="center">图2. 左：CMOS传感器示意图 右：卷帘快门“果冻”效应</p>
　　现在通过激活要读取的行的行选择信号来执行CMOS图像传感器的读出过程，该行选择信号将该行的像素连接到列放大器。读出是两步过程，首先读出浮动扩散复位后的信号，并将其存储在列级的采样和保持电路中。在此之后，立即读出光信号并减去复位信号，然后由ADC将结果转换为数字编号并从传感器读出。

　　由于行是按顺序读出的，因此在阵列上累积的每一行的积分之间会有一段时间延迟。如图3左所示。该卷帘快门是CMOS图像传感器的特征，其在包含移动物体的图像中引入失真。失真量将取决于诸如帧速率（每秒捕获的帧数）以及移动物体的速度和方向等因素。当手机或物体移动时，手机拍摄的视频中出现的“果冻”印象是由于这种现象造成的。滚动快门效果的图像示例如图2右所示:

<center>![卷帘快门曝光示意图](https://pic3.zhimg.com/80/v2-0565dea47aedba0b68af08b810e7acde_hd.jpg)</center>
<p align="center">图3.卷帘快门曝光示意图</p>

### 3. 全局快门

　　和卷帘快门相比，全局快门(global shutter)最主要的区别是在每个像素处增加了采样保持单元，在指定时间达到后对数据进行采样然后顺序读出，这样虽然后读出的像素仍然在进行曝光，但存储在采样保持单元中的数据却并未改变。这种结构的主要缺点在于增加了每个像素的元件数目，使得填充系数降低，所以高分辨率的sensor设计难度和生产成本都很高，另外采样保持单元还引入了新的噪音源。

　　CCD相机通常在全局快门(global shutter)模式下使用行间传输CCD。 在全局快门模式下，每个像素在同一时刻同时曝光。 当图像逐帧变化时，这尤其有用。 然而，当涉及帧速率时，CCD具有固有的缺点。 曝光完成后，来自每个像素的信号被串行传输到单个模数转换器（A / D）。CCD的最终帧速率受到单个像素传输然后数字化的速率的限制。 传感器中传输的像素越多，相机的总帧速率就越慢。

　　CCD传感器具有“免费”全局快门的优点。对于行间CCD，所有像素都同时移入传输寄存器。帧传输CCD将类似地允许全局电子快门，因为电荷包可以如此快地向下移动到光屏蔽区域中，使得与第一行相比，最后行的累积额外电荷可以忽略不计。然而，当在图像的一部分中存在强光源时，在这种类型的传感器中可能发生称为拖尾的现象。当电荷包向下移动通过光源照射的区域时，它们可以累积足够的信号以产生通过光源的图像从顶部到底部垂直延伸的亮条纹。行间CCD也会受到拖尾的影响，但在这种情况下，原点是由于光子散射到垂直传输寄存器中。

　　除了消除滚动快门效果之外，全局快门的另一个重要应用是闪光摄影。在下面更详细描述的氙闪光灯的情况下，闪光脉冲太短以至于顶部和底部行很可能不会被闪光灯同时曝光，导致图像中的亮带和暗带。当曝光时间等于反帧速率时，发生所有行同时曝光的唯一情况。然后，如果最高帧速率是例如每秒30帧，则使用闪光灯时可达到的最短曝光时间是1/30秒。对于手机摄像头，f值大约在2.0-2.8之间无法更改，这意味着只有在场景太暗以至于没有被闪光灯照亮的背景时，才能使用闪光灯。不要被环境光过度曝光。为了扩展闪光灯的有用性，必须允许更短的曝光时间。因此，必须使用全球机械或电子快门。

　　与行间传输CCD一样，CMOS像素内的额外元件将限制填充因子。这可以通过在像素阵列顶部添加微透镜来解决。该技术用于CCD和CMOS传感器，并且随着像素尺寸不断缩小而变得越来越重要。

　　可以通过使用外部机械快门来获得用于CMOS传感器的全局快门。在这种情况下，采用全局重置。实际上，这意味着机械快门首先完全打开，所有光电二极管同时复位，然后开始集成如图4。

<center>![有全局重置和机械快门的卷帘快门CMOS曝光示意图](https://pic2.zhimg.com/v2-9812bdcc98ae5b42f536dd3ccb8117c1_r.jpg)</center>
<p align="center">图4. 有全局重置和机械快门的卷帘快门CMOS曝光示意图</p>
　　在积分期结束时，机械快门关闭。然后可以按顺序读出像素行，就像在卷帘式情况下一样。由于在读出期间没有光将到达像素，因此获得正确曝光的图像。该方案的一个缺点是如果像素的暗电流足够大，则图像将包含在图像上改变的暗电平偏移。这也会导致图像上的暗噪声发生变化。在今天的CMOS传感器中，暗电流通常很低，这很可能不是问题。

### 附录

> 1. [全局快门和卷帘式快门](https://zhuanlan.zhihu.com/p/50798074)