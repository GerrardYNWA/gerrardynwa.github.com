title: 视觉SLAM十四讲——视觉里程计（特征点法）
date: 2017-10-09 22:27:49
categories: Algorithm

tags: [computer vision, slam]
---

　　重新整理学习《视觉SLAM十四讲》：视觉里程计（特征点法）
<!-- more -->

## 1. 特征点提取与匹配

- 经典SLAM模型中以位姿-路标来描述SLAM过程
  - 路标是三维空间中固定不变的点，能够在特定位姿下观测到
  - 数量充足，以实现良好的定位
  - 较好的区分性，以实现数据关联
- 在视觉SLAM中，可利用图像特征点作为SLAM中的路标
- 特征点：图像中具有代表性的部分
  - 可重复性
  - 可区别性
  - 高效
  - 本地
- 特征点的信息
  - 位置、大小、方向、评分等-关键点
  - 特征点周围的图像信息-描述子
- ORB特征（平移、旋转不变性，无尺度不变性）
  - 关键点：Oriented FAST（16中连续9或10）
  - 描述字：BRIEF（在特征点附近的128次像素比较，256，512）
- 特征匹配
  - 暴力匹配
  - 加速：快速最近邻（FLANN）

## 2. 2D-2D对极几何

- 几何关系
- 对极约束
  - 两步计算位姿
    - 由匹配点计算E
    - 由E恢复R、t
  - 性质
    - 乘人意非零常数依然满足
    - E共五个自由度（五点法和八点法）
  - 八点法计算E
  - 从E计算R、t：奇异值分解（四个可能的解，但只有一个深度为正）
    - E的内在性质要求它的奇异值为$\sigma,\sigma,0$
  - 最少可使用五个点计算R、t，但需要利用E的非线性性质，原理较复杂
  - 八点法的讨论
    - 用于单目SLAM的初始化
    - 尺度不确定性：归一化t或特征点的平均深度
    - 纯旋转问题：t=0时无法求解
    - 多于八对点时：最小二乘
    - 有外点时：RANSAC
- 从单应矩阵恢复R、t
  - 八点法在特征点共面时会退化
  - 设特征点位于某平面上
  - 两个图像特征点的坐标关系
  - 该式是在非零因子下成立
  - 类似八点法
    - 先算H
    - 再用H恢复R、t、n、d、K（八选一）
- 小结
  - 2D-2D情况下，只知道图像坐标之间的对应关系
    - 当特征点再平面上时（例如俯视或仰视），使用H恢复R、t
    - 否则，使用E或F 恢复R、t
    - t没有尺度
  - 求得R、t后：
    - 利用三角化计算特征点的3D位置（即深度）
  - 实际中用于单目SLAM的初始化部分

## 3. PnP

已知3D点的空间位置和相机上的投影点，求相机的旋转和平移（外参）

- DLT（线性解法）
  - 把它看成一个关于t的线性方程，求解t
  - 为求解12个未知数，需要12/2=6对点（超定时求最小二乘解）
  - DLT将R、t看成独立的未知量，所以在求出结果后，需要将t组成的矩阵投影回SO(3)（通常采用QR分解实现）
- P3P
- EPnP
- UPnP
- PnP的优化解法：Bundle Adjustment
  - 最小化重投影误差
  - 根据投影关系，定义重投影误差并取最小化
  - 线性化和雅可比

## 4. ICP

给定 配对好的两组3D点，求其旋转和平移 ，可用ICP求解

- SVD
- BA：ICP也可以从非线性优化角度求解，但：
  - 已知匹配时，ICP问题存在唯一解或无穷多解的情况。在唯一解的清咖 u 能够相爱，只要能找到极小值解，那么这个极小值就是全局最优解
  - 所以正常情况下，SVD结果和优化一样，且优化很快收敛
- 注
  - 在激光情况下，匹配点未知，将制定最近点为匹配点。此时问题非凸，极小值不一定为最小值
  - 利用非线性优化可以将ICP与PnP结合在一起求解

## 5. 三角化与深度估计

- 已知运动时，求解特征点的3D位置
- 三角化中的问题
  - 解的深度的质量与平移相关
  - 但是平移大时特征匹配可能不成功

## 6. 面试题



