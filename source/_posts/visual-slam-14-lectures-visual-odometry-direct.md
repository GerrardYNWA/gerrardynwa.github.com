title: 视觉SLAM十四讲——视觉里程计（光流法和直接法）
date: 2017-10-22 22:27:49
categories: Algorithm

tags: [computer vision, slam]
---

　　重新整理学习《视觉SLAM十四讲》：视觉里程计（光流法和直接法）
<!-- more -->

## 1. 光流法

  - 不使用特征匹配的思路
    - 通过其他方式寻找配对点：光流法
    - 不需要配对点-直接法
  - 光流：追踪元图像某个点在其他图像中的运动
  - 一般分为稀疏光流和稠密光流
    - 稀疏以LK光流为代表
    - 稠密以HS光流为代表
    - 本质上是估计像素在不同时刻图像中的运动
  - 灰度不变假设：是一种理想的假设，实际当中由于高光/阴影/材质/曝光等不同，很可能不成立
  - 二元一次线性方程，欠定
    - 需要引用额外的约束
    - 假定一个窗口内光度不变
    - 通过超定最小二乘解求运动u、v（伪逆）
  - 图像金字塔
  - 注解：
    - 可以看成最小化像素误差的非线性优化
    - 每次使用Taylor一阶近似，在离优化较远时效果不佳，往往需要迭代多次
    - 运动较大时要使用金字塔
    - 可以用于跟踪图像中的稀疏关键点的运动轨迹
    - 得到匹配点后，后续计算与特征点VO中相同
    - 按方法可分为正向/反向+平移/组合的方式（旋转）
  - 光流仅估计了像素间的平移，但
    - 没有用到相机本身的几何结构
    - 没有考虑到相机的旋转和图像的缩放
    - 对于边界上的点，光流不好追踪
    - 直接法则考虑了这些信息

## 2. 直接法

  - 直接法的推导
  - 为了估计相机的运动，建立最小化问题
    - 最小化光度误差
    - 待估计的量为相机运动，我们关心误差相对于相机的导数
  - 第一部分：图像梯度
  - 第二部分：像素对投影点导数
  - 第三部分：投影点位姿导数
  - 可以看到，直接法的雅可比项有一个图像梯度因子
    - 因此，在图像梯度不明显的地方，对相机运动估计的贡献就小
  - 根据使用的图像信息不同，可分为：
    - 稀疏直接法：只处理稀疏角点或关键点
    - 稠密直接法：使用所有像素
    - 半稠密直接法：使用部分梯度明显的像素
  - 直接法的直观解释
    - 像素灰度引导着优化的方向
    - 要使优化成立，必须保证从初始估计到最优估计中间的梯度一直下降
    - 这很容易受到图像非凸性的影响（可部分地由金字塔减轻
  - 优缺点小结
    - 优势
      - 省略特征提取的时间
      - 只需要有像素梯度而不必是角点（对白墙等地方有较好效果
      - 可稠密或半稠密
    - 劣势
      - 灰度不变难以满足（易受曝光和模糊影响）
      - 单像素区分性差
      - 图像非凸性

## 3. 面试题

